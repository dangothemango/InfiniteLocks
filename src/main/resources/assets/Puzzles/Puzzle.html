{% extends "../layout.html" %}
{% block content %}

<form id="unlockForm" action="/unlock" method="POST">
    <input type="text" name="key" id="keyInput">

    <button type ="Submit" name ="submit">Unlock</button>
</form>
<br/>
<br/>

{% block puzzle %} {% endblock %}

<script type="text/javascript">

    $('#unlockForm').submit(function(e){
        e.preventDefault();

        var json = {};

        json["lock"] = "{{ lockName }}";
        json["key"] = $("#keyInput").value;

        $.ajax({
            url: "/lock/unlock",
            type: "POST",
            data: JSON.stringify(json),
            dataType: "json",
            contentType: "application/json",
            success: function (data) {
                var response = $.parseJSON(data);
                console.log(response);
                if (response.result.toUpperCase() === "SUCCESS") {
                    console.log("Success")
                } else {
                    alert("This key doesnt fit")
                }
            },
            error: function (data) {
                alert(data.responseText)
            }
        });

        return false; // return false to prevent typical submit behavior

    });

</script>

{% endblock %}